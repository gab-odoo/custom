<?xml version="1.0" encoding="utf-8"?>
<openerp>
<data>

    <template id="layout" name="B2B Layout" inherit_id="website.layout">
        <xpath expr="//t[@t-call-assets='web.assets_common']" position="attributes">
            <attribute name="t-js"></attribute>
        </xpath>
        <xpath expr="//t[@t-call-assets='web.assets_common']" position="after">
            <link rel="stylesheet" href="/website_b2b/static/src/css/website_b2b.css"/>
            <link rel="icon" href="/website_b2b/static/src/img/favicon.ico" type="image/x-icon"/>
            <script type="text/javascript" src="/website_b2b/static/src/js/layout_improvements.js"/>
        </xpath>
    </template>


    <!-- Landing page -->
    <template id="welcome_page" name="B2B Home Page">
        <t t-call="website.layout">
            <div class="wrap">
                <div class="container">
                    <div class="col-md-2 col-xs-0">
                        <img src="/website_b2b/static/src/img/sidebar.png" style="max-width:100%;margin-top:100px"/>
                    </div>
                    <div class="col-md-10 col-xs-12">
                        <div class="col-md-12">
                            <h1>Ihre Kommission</h1>
                            <p>Willkommen <t t-esc="user.name"/> (<t t-esc="user.login"/>)</p><br/>
                            <p>Als Feuerwear-Kommissionshändler stellen wir Ihnen Ware unter Eigentumsvorbehalt zur Verfügung. Sie verkaufen die
                            Ware an Endkunden und rechnen dann die Verkäufe anschließend mit Feuerwear ab.
                            Für die Abrechnung können Sie wählen, ob Sie eine <a href="/website/action/website_b2b.report?mode=inventory">Lagerbestandsmeldung</a> machen möchten (wir errechnen die Verkäufe),
                            oder ob Sie direkt eine <a href="/website/action/website_b2b.report?mode=sales">Verkaufsmeldung</a> machen möchten. Auf beiden Wegen erhalten Sie eine Rechnung über verkaufte
                            Kommissionsware und eine Nachlieferung für Ihren Zielbestand.</p><br/>
                            <p>Ihr Lager: <t t-raw="location.complete_name if location else '&lt;em&gt;no location associated to this user&lt;/em&gt;'"/></p><br/><br/>
                        </div>
                        <t t-if="location">
                            <div class="col-md-12">
                                <div class="col-md-3 col-xs-0">
                                    <img src="/website_b2b/static/src/img/stack.png" style="max-width:130px"/>
                                </div>
                                <div class="col-md-9">
                                    <a href="/website/action/website_b2b.report?mode=inventory" class="btn btn-primary">Meinen Lagerbestand melden</a>
                                    <br/>
                                    <p>Teilen Sie uns mit, wie Ihr Feuerwear-Sortiment aktuell bestückt ist. Sie erhalten eine Rechnung
                                                            über verkaufte Kommissionsware und eine Nachlieferung für Ihren Zielbestand.</p>
                                    <br/><br/>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="col-md-3 col-xs-0">
                                    <img src="/website_b2b/static/src/img/sales.png" style="max-width:150px"/>
                                </div>
                                <div class="col-md-9">
                                    <a href="/website/action/website_b2b.report?mode=sales" class="btn btn-primary">Meine Verkäufe melden</a>
                                    <br/>
                                    <p>Teilen Sie uns mit, wieviele Feuerwear-Produkte Sie verkauft haben. Sie erhalten eine Rechnung
                                                            über verkaufte Kommissionsware und eine Nachlieferung für Ihren Zielbestand.</p>
                                    <br/><br/>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="col-md-3 col-xs-0">
                                    <img src="/website_b2b/static/src/img/order.png" style="max-width:150px"/>
                                </div>
                                <div class="col-md-9">
                                    <a href="/website/action/website_b2b.confirm_do_new_delivery" class="btn btn-primary">Bestellung aufgeben</a>
                                    <br/>
                                    <p>Hier können Sie Ware nachordern, ohne eine Meldung zu machen.</p>
                                    <br/><br/>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="col-md-3 col-xs-0">
                                    <img src="/website_b2b/static/src/img/overview.png" style="max-width:150px"/>
                                </div>
                                <div class="col-md-9">
                                    <a href="/website/action/website_b2b.overview" class="btn btn-primary">Übersicht</a>
                                    <p>Alles auf einen Blick: Lieferungen, Offene Sendungen, Retouren,
                                                            Rechnungen und Lagerbestand</p>
                                    <br/><br/>
                                </div>
                            </div>
                        </t>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <!-- Sales/Inventory -->
    <template id="sales_inventory_page" name="B2B Report Sales/Inventory">
        <t t-call="website.layout">
            <t t-set="head">
                <script type="text/javascript" src="/website_b2b/static/src/js/sales_inventory_report.js"/>
            </t>
            <div class="responsive-background" style="background-image: url(/website_b2b/static/src/img/bg.jpg);position:fixed;">
                    </div>
            <div class="responsive-background" style="background-color: rgba(255, 255, 255, 0.5);position:fixed;">
                    </div>
            <div class="wrap">

                <div class="container">
                    <ol class="breadcrumb" style="position: fixed;top: 100px;">
                        <li><a href="/website/action/website_b2b.welcome"><i class="fa fa-home"/></a></li>
                        <li t-if="mode == 'inventory'" class="active">Lagerbestand melden</li>
                        <li t-if="mode == 'sales'" class="active">Verkäufe melden</li>
                    </ol>
                    <t t-if="mode == 'inventory'">
                        <h1 style="position: fixed;top: 115px;">Lagerbestand melden</h1>
                        <table id="uhelp" style="position: fixed;top: 180px ;width: 70%;">
                            <tr>
                                <td>
                                    <img src="/website_b2b/static/src/img/stack.png" style="max-width:110px"/>
                                </td>
                                <td>
                                    <p>
                                        Die Lagerbestandsmeldung besteht aus drei Schritten:<br/>
                                        <span style="color:#d2232a">Schritt 1:</span>Tragen Sie ihren aktuellen Bestand in der markierten Spalte ein. Die Verkäufe werden automatisch errechnet.<br/>
                                        <span style="color:#808080">Schritt 2: Bestätigen sie die Rechnung und Sie erhalten unsere Rechnung über die verkaufte Kommissionsware.</span><br/>
                                        <span style="color:#808080">Schritt 3: Um ihre vereinbarten Zielbestände wieder aufzufüllen, errechnen wir automatisch, wieviel Ware Sie benötigen. Wenn Sie mehr Ware als den Zielbestand benötigen, fügen Sie unten in der Liste Ihre Wunschartikel hinzu.</span><br/>
                                    </p>
                                </td>
                            </tr>
                        </table>
                    </t>
                    <t t-if="mode == 'sales'">
                        <h1 style="position: fixed;top: 115px;">Verkäufe melden</h1>
                        <table id="uhelp" style="position: fixed;top: 180px ;width: 70%;">
                            <tr>
                                <td>
                                    <img src="/website_b2b/static/src/img/sales.png" style="max-width:130px"/>
                                </td>
                                <td style="margin-left:20px">
                                    <p>
                                        Die Verkaufsmeldung besteht aus drei Schritten:<br/>
                                        <span style="color:#d2232a">Schritt 1:</span>Tragen Sie ihre aktuellen Verkäufe in der markierten Spalte ein.<br/>
                                        <span style="color:#808080">Schritt 2: Bestätigen Sie die Rechnung. Unsere Rechnung über die verkaufte Kommissionsware wird automatisch erstellt.</span><br/>
                                        <span style="color:#808080">Schritt 3: Um ihre vereinbarten Zielbestände wieder aufzufüllen, errechnen wir automatisch, wieviel Ware Sie benötigen. Wenn Sie mehr Ware als den Zielbestand benötigen, fügen Sie unten in der Liste Ihre Wunschartikel hinzu.</span><br/>
                                    </p>
                                </td>
                            </tr>
                        </table>
                    </t>
                    <form method="post" t-att-name="mode" action="/website/action/website_b2b.invoice" class="responsive-margin-top">
                        <table class="table table-hover table-condensed table-responsive">
                            <tr class="fixed-header">
                                <th style="width: 20%;"> </th>
                                <th style="width: 20%;">Artikel</th>
                                <th style="width: 20%;">Kategorie</th>
                                <th style="width: 20%;">Zuletzt gemeldeter Bestand</th>
                                <th style="width: 20%;" t-if="mode == 'inventory'">Aktueller Bestand</th>
                                <th style="width: 20%;" t-if="mode == 'sales'">Mein Verkäufe an Endkunden</th>
                            </tr>
                            <t t-as='p' t-foreach='products'>
                                <tr class="js_row" style="width: 70%;">
                                    <td style="width: 20%;">
                                        <img t-att-src="'/website/image?model=product.product&amp;field=image_medium&amp;id=' + str(p.id)" height="128" width="128"/>
                                    </td>
                                    <td t-esc='p.name' style="width: 20%;"/>
                                    <td t-esc='p.categ_id.name' style="width: 20%;"/>
                                    <td class="js_stock" t-esc='"%d" % p.qty_available' style="width: 20%;"/>
                                    <td style="width: 20%;">
                                        <input type="number" t-att-name="p.id" min="0" value="0" step="1.0" class="js_in"/>
                                    </td>
                                </tr>
                            </t>
                        </table>
                        <div class="alert alert-warning alert-dismissable">
                            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&amp;times;</button>
                            <strong>Achtung!</strong> Bevor Sie fortfahren, vergewissern Sie sich, dass die Mengen korrekt sind.<strong>Dies wird eine Rechnung erstellen.</strong>
                        </div>
                        <div class="alert alert-danger hidden js_overflow_alert">
                            <t t-if="mode == 'inventory'">Sie sollten keinen höheren Lagerbestand als die letzte Lagermeldung eintragen. Sind Sie sicher?</t>
                            <t t-if="mode == 'sales'">Sie können keine Verkaufsmeldung erstellen, die über ihr Lagerbestand hinausgeht. Bitte erstellen Sie eine Lagerbestandsmeldung.</t>
                            Bitte überprüfen Sie die rot hinterlegten Zeilen.
                        </div>
                        <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                        <center>
                            <a href="/website/action/website_b2b.welcome" class="btn btn-default">Zurück</a>
                            <input type="hidden" name="mode" t-att-value="mode" />
                            <button t-if="mode == 'inventory'" type="submit" class="btn btn-primary">Bestandsmeldung bestätigen &amp; weiter</button>
                            <button t-if="mode == 'sales'" type="submit" class="btn btn-primary js_sbutton">Verkaufsmeldung bestätigen &amp; weiter</button>
                        </center>
                    </form>
                    <br/><br/>
                </div>
            </div>
        </t>
    </template>

    <template id="invoice_page" name="B2B Invoice">
        <t t-call="website.layout">
            <div class="wrap">
                <div class="container">
                    <div class="oe_structure" />
                    <ol class="breadcrumb">
                        <li><a href="/website/action/website_b2b.welcome"><i class="fa fa-home"/></a></li>
                        <li t-if="mode == 'inventory'">Lagerbestand melden</li>
                        <li t-if="mode == 'sales'">Verkäufe melden</li>
                        <li class="active">Rechnung</li>
                    </ol>
                    <h1>Rechnung</h1>
                    <form t-if="do" action="/website/action/website_b2b.confirm_do_new_delivery" method="post" name="confirm_do_new_delivery">
                        <input type="hidden" name="stock.picking_id" t-att-value="do.id"/>
                        <input type="hidden" name="all_pickings_ids" t-att-value="','.join(['%d' % p.id for p in all_pickings])"/>
                        <table class="table table-hover table-condensed">
                            <tr>
                                <th>Artikel</th>
                                <th>Kategorie</th>
                                <th t-if="mode == 'inventory'" class="text-right">Zuletzt gemeldeter Bestand</th>
                                <th t-if="mode == 'inventory'" class="text-right">Aktuell gemeldeter Bestand</th>
                                <th class="text-right">Verkäufe an Endkunden</th>
                                <th class="text-right">Einzelpreis</th>
                                <th class="text-right">Gesamtpreis</th>
                            </tr>
                            <t t-as='picking' t-foreach='all_pickings'>
                                <tr t-as='line' t-foreach='picking.move_lines'>
                                    <td><span t-esc='line.product_id.name'/></td>
                                    <td t-esc='line.product_id.categ_id.name'/>
                                    <td class="text-right" t-if="mode == 'inventory'"><span t-esc="'%d' % line.product_id.qty_available"/></td>
                                    <td class="text-right" t-if="mode == 'inventory'"><span t-esc="stock_reported_by_you.get(str(line.product_id.id))"/></td>
                                    <t t-if="line.location_id.id == location_id">
                                        <td class="text-right text-danger"><span t-esc='"%d" % line.product_qty'/></td>
                                    </t>
                                    <t t-if="line.location_id.id != location_id">
                                        <td class="text-right text-danger"><span t-esc='"%d" % -line.product_qty'/></td>
                                    </t>
                                    <td class="text-right"><span t-esc='"%.2f" % line.product_id.lst_price'/></td>
                                    <t t-if="line.location_id.id == location_id">
                                        <td class="text-right"><span t-esc='"%.2f" % (line.product_qty * line.product_id.lst_price)'/></td>
                                    </t>
                                    <t t-if="line.location_id.id != location_id">
                                        <td class="text-right"><span t-esc='"%.2f" % (-line.product_qty * line.product_id.lst_price)'/></td>
                                    </t>
                                </tr>
                            </t>
                            <tr>
                                <td colspan="7 if mode='inventory' else 5" class="text-right"><strong>Summe: <span t-esc="'%.2f' % total"/></strong></td>
                            </tr>
                        </table>
                        <div class="alert alert-warning alert-dismissable">
                            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&amp;times;</button>
                            <strong>Achtung!</strong> Wenn Sie fortfahren, wird diese Rechnung bestätigt.
                        </div>
                        <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                        <center>
                            <button type="submit" class="btn btn-danger">Rechnung bestätigen &amp; weiter</button>
                        </center>
                    </form>
                    <div t-if="not do">
                        <p class="well">Es gibt nichts zu berechnen. Entweder Ihr Lager hat sich nicht verändert, oder Sie haben seit der letzten Meldung keine Verkäufe getätigt.</p>
                        <center>
                            <a class="btn btn-default" t-att-href="'/website/action/website_b2b.report?mode=%s' % mode">Zurück</a>
                            <a class="btn btn-primary" href="/website/action/website_b2b.confirm_do_new_delivery">Das ist Korrekt</a>
                        </center>
                    </div>
                    <div class="oe_structure"/>
                    <br/><br/>
                </div>
            </div>
        </t>
    </template>

    <template id="new_delivery_page" name="B2B New Delivery">
        <t t-call="website.layout">
            <t t-set="head">
                <script type="text/javascript" src="/website_b2b/static/src/js/new_delivery.js"/>
            </t>
            <div class="responsive-background" style="background-image: url(/website_b2b/static/src/img/bg.jpg);position:fixed;">
                    </div>
            <div class="responsive-background" style="background-color: rgba(255, 255, 255, 0.5);position:fixed;">
                    </div>
            <div class="wrap">
                <div class="container">
                    <div class="oe_structure"/>
                    <ol class="breadcrumb" style="position: fixed;top: 100px;">
                        <li><a href="/website/action/website_b2b.welcome"><i class="fa fa-home"/></a></li>
                        <li>Meldung</li>
                        <li>Rechnung</li>
                        <li class="active">Nachlieferung</li>
                    </ol>
                    <h1 style="position: fixed;top: 115px;">Nachlieferung bestätigen</h1>
                    <table id="uhelp" style="position: fixed;top: 180px ;width: 70%;">
                        <tr>
                            <td>
                                <img src="/website_b2b/static/src/img/order.png" style="max-width:110px"/>
                            </td>
                            <td>
                                <p>
                                    Die Verkaufsmeldung besteht aus drei Schritten:<br/>
                                    <span style="color:#808080">Schritt 1: Tragen Sie ihre aktuellen Verkäufe in der markierten Spalte ein.<br/>
                                    Schritt 2: Bestätigen Sie die Rechnung. Unsere Rechnung über die verkaufte Kommissionsware wird automatisch erstellt.</span><br/>
                                    <span style="color:#d2232a">Schritt 3:</span> Um ihre vereinbarten Zielbestände wieder aufzufüllen, errechnen wir automatisch, wieviel Ware Sie benötigen. Wenn Sie mehr Ware als den Zielbestand benötigen, fügen Sie unten in der Liste Ihre Wunschartikel hinzu.<br/>
                                </p>
                            </td>
                        </tr>
                    </table>
                    <form action="/website/action/website_b2b.finish" method="post" name="new_delivery_page" class="responsive-margin-top">
                        <input type="hidden" name="inv" t-att-value="inv"/>
                        <table class="table table-hover table-condensed table-responsive">
                            <tr class="fixed-header">
                                <th style="width: 10%;"> </th>
                                <th style="width: 10%;">Artikel</th>
                                <th style="width: 10%;">Kategorie</th>
                                <th style="width: 10%;" class="text-right">Aktueller Bestand</th>
                                <th style="width: 10%;" class="text-right">Bestand inkl. offene Lieferungen</th>
                                <th style="width: 10%;" class="text-right">Zielbestand</th>
                                <th style="width: 10%;" class="text-right">Nachlieferung</th>
                                <th style="width: 10%;" class="text-right">Zusätzlich gewünschte Artikel</th>
                                <th style="width: 10%;" class="text-right">Lieferung gesamt</th>
                            </tr>
                            <t t-set="productssorted" t-value="products.sorted(key=lambda r: r.sequence)"/>
                            <tr t-as='product' t-foreach='productssorted' class="js_row">
                                <td>
                                    <img t-att-src="'/website/image?model=product.product&amp;field=image_medium&amp;id='+str(product.id)" height="128" width="128"/>
                                </td>
                                <td>
                                    <span t-esc='product.name'/>
                                </td>
                                <td>
                                    <span t-esc='product.categ_id.name'/>
                                </td>
                                <td class="text-right">
                                    <span t-esc="'%d' % product.qty_available"/>
                                </td>
                                <td class="text-right">
                                    <span t-esc="'%d' % product.virtual_available"/>
                                </td>
                                <t t-set="orderpoints" t-value="[op.product_min_qty for op in product.orderpoint_ids if op.location_id.id == location_id]"/>
                                <t t-set="orderpoint" t-value="orderpoints[0] if orderpoints else 0"/>
                                <td class="text-right">
                                    <span t-esc='"%d" % orderpoint'/>
                                </td>
                                <t t-set="delivery" t-value="orderpoint - product.virtual_available if product.virtual_available &lt; orderpoint else 0"/>
                                <td class="text-right text-danger">
                                    <span t-esc='"%d" % delivery'/>
                                    <input class="js_delivery" type="hidden" t-att-name="'delivery_%d' % product.id" t-att-value='"%d" % delivery'/>
                                </td>
                                <td class="text-right">
                                    <input type="number" t-att-name="'additionnal_%d' % product.id" value="0" min="0" step="1.0" class="js_additionnal"/>
                                </td>
                                <td class="text-right text-danger">
                                    <span class="js_total" t-esc='"%d" % delivery'/>
                                </td>
                            </tr>
                        </table>
                        <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                        <center>
                            <button type="submit" class="btn btn-danger">Nachlieferung bestätigen</button>
                        </center>
                    </form>
                    <div class="oe_structure"/>
                    <br/><br/>
                </div>
            </div>
        </t>
    </template>

    <template id="final_do_page" name="B2B Final Delivery Order">
        <t t-call="website.layout">
            <div class="wrap">
                <div class="container">
                    <div class="oe_structure"/>
                    <ol class="breadcrumb">
                        <li><a href="/website/action/website_b2b.welcome"><i class="fa fa-home"/></a></li>
                        <li>Meldung</li>
                        <li>Rechnung</li>
                        <li>Nachlieferung</li>
                        <li class="active">Bestätigung</li>
                    </ol>
                    <h1>Bestellung abgeschlossen</h1>
                    <table>
                        <tr>
                            <td>
                                <img src="/website_b2b/static/src/img/stack.png" style="max-width:110px"/>
                            </td>
                            <td>
                                <p>
                                    Vielen Dank für Ihre Bestellung. Sie erhalten eine separate Auftragsbestätigung mit Angabe der Verfügbarkeit der einzelnen Artikel.
                                    Nach Versand der verfügbaren Ware erhalten Sie eine eMail mit der Sendungsverfolgungsnummer an: <t t-esc="user.login"/>.
                                </p>
                            </td>
                        </tr>
                    </table>
                    <div t-if="do">
                        <table t-if="do" class="table table-hover table-condensed">
                            <tr>
                                <th>Artikel</th>
                                <th>Kategorie</th>
                                <th class="text-right">Menge</th>
                            </tr>
                            <tr t-as='line' t-foreach='do.move_lines'>
                                <td><span t-esc='line.product_id.name'/></td>
                                <td><span t-esc='line.product_id.categ_id.name'/></td>
                                <td class="text-right"><span t-esc='"%d" % (line.product_qty)'/></td>
                            </tr>
                        </table>
                    </div>
                    <div t-if="not do">
                        <p class="alert alert-warning">Sie haben nichts nachbestellt.</p>
                    </div>
                    <center t-if='do'>
                        <div class="alert alert-success"><p> <t t-esc="do.name"/> - <t t-esc="do.date"/></p>
                        <p>Diese Nachbestellung wurde in unser System gespeichert</p>
                        <!--<p>Note: Shipping costs have been recorded under invoice  <t t-esc="inv.number"/></p>--></div>
                    </center>
                    <div class="well">
                        <center>
                        <p><strong>Ihre Meldung ist nun abgeschlossen!</strong></p>
                        <a class="btn btn-primary" href="/website/action/website_b2b.welcome"><i class="fa fa-home"/> Zurück zur Homepage</a>
                        </center>
                    </div>
                    <div class="oe_structure"/>
                    <br/><br/>
                </div>
            </div>
        </t>
    </template>

    <!-- Overview -->

    <template id="website_layout_overview" name="B2B Overview" inherit_id="website.layout" primary="True">
        <xpath expr="//div[@id='wrapwrap']" position="attributes">
            <attribute name="id"></attribute>
        </xpath>
        <xpath expr="//body" position="attributes">
            <attribute name="style">overflow-x:auto</attribute>
        </xpath>
    </template>

    <template id="partner_overview_page" name="B2B Overview">
        <t t-call="website_b2b.website_layout_overview">
            <div class="wrap" style="margin-top:0px !important;padding-top:80px">
                <div style="margin-left:50px">
                    <ol class="breadcrumb" style="width:20%">
                        <li><a href="/website/action/website_b2b.welcome"><i class="fa fa-home"/></a></li>
                        <li class="active">Übersicht</li>
                    </ol>
                    <h1>Übersicht</h1>
                    <table>
                        <tr>
                            <td rowspan="7">
                                <img src="/website_b2b/static/src/img/overview.png" style="max-width:190px"/>
                            </td>
                            <td colspan="3">
                                <p>In der Übersicht fassen wir alle Informationen zur Feuerwear-Kommissionsware für Sie zusammen.</p>
                            </td>
                        </tr>
                        <tr>
                            <td/>
                            <td>Offene Lieferungen</td><td>– noch nicht von Feuerwear bearbeitete Bestellungen.</td>
                        </tr>
                        <tr>
                            <td/>
                            <td>Abgeschlossene Lieferungen </td><td> – Eine Übersicht aller abgeschlossenen Lieferungen.</td>
                        </tr>
                        <tr>
                            <td/>
                            <td>Retouren</td><td>– Beinhaltet alle von Ihnen zurück gesandten Artikel.</td>
                        </tr>
                        <tr>
                            <td/>
                            <td>Rechnungen</td><td>– Hier finden Sie alle Ihre Rechnungen.</td>
                        </tr>
                        <tr>
                            <td/>
                            <td>Lagerbestand</td><td>– Ihr aktueller Warenbestand vor Ort. Abgeschlossene Lieferungen werden ab Versand bereits hinzu gezählt.</td>
                        </tr>
                        <tr>
                            <td/>
                            <td>Zielbestand</td><td>– Hier sehen Sie die vereinbarten Zielbestände.</td>
                        </tr>
                    </table>
                    <!-- Open Deliveries -->
                    <div class="panel panel-default" style="display:inline-block">
                        <div class="panel-heading">
                            <h2 class="panel-title"><a name="open" href="#open">Offene Lieferungen</a></h2>
                        </div>
                        <table class="table table-hover table-condensed">
                            <colgroup width="200"/>
                            <tr>
                                <th class="big-cell">Datum</th>
                                <th class="big-cell">Referenz</th>
                                <t t-foreach="stock" t-as="product"><th t-esc="product.name" class="text-center cell"/></t>
                            </tr>
                            <tr t-foreach="open_deliveries" t-as="deliv">
                                <td t-esc="str(deliv.date)[:10]" class="big-cell"/>
                                <!-- <td><a t-att-href="'/web#model=stock.picking&amp;view_type=form&amp;id=%d' % deliv.id" target="_blank"><t t-esc="deliv.name"/></a></td> -->
                                <td class="big-cell"><a t-att-href="'/report/pdf/stock.report_picking/%d' % deliv.id" target="_blank"><t t-esc="deliv.name"/></a></td>
                                <t t-set="lines_of_products" t-value="dict([(l.product_id.id, l.product_qty) for l in deliv.move_lines])"/>
                                <t t-foreach="stock" t-as="product"><td t-esc="'%d' % lines_of_products.get(product.id, 0)" class="text-center cell"/></t>
                           </tr>
                           <tr>
                                <th>Summe</th>
                                <th/>
                                <t t-foreach="stock" t-as="product">
                                    <t t-set="lines_of_products_sum" t-value="sum([l.product_qty for deliv in open_deliveries for l in deliv.move_lines if l.product_id.id == product.id])"/>
                                    <th t-esc="int(lines_of_products_sum)" class="text-center cell"/>
                                </t>
                            </tr>
                        </table>
                    </div>
                    <!-- Completed Deliveries -->
                    <div class="panel panel-default" style="display:inline-block">
                        <div class="panel-heading">
                            <h2 class="panel-title"><a name="completed" href="#completed">Abgeschlossene Lieferungen</a></h2>
                        </div>
                        <table class="table table-hover table-condensed">
                            <colgroup width="200"/>
                            <tr>
                                <th class="big-cell">Datum</th>
                                <th class="big-cell">Referenz</th>
                                <t t-foreach="stock" t-as="product"><th t-esc="product.name" class="text-center cell"/></t>
                            </tr>
                            <tr t-foreach="completed_deliveries" t-as="deliv">
                                <td t-esc="str(deliv.date)[:10]" />
                                <!-- <td><a t-att-href="'/web#model=stock.picking&amp;view_type=form&amp;id=%d' % deliv.id" target="_blank"><t t-esc="deliv.name"/></a></td> -->
                                <td><a t-att-href="'/report/pdf/stock.report_picking/%d' % deliv.id" target="_blank"><t t-esc="deliv.name"/></a></td>
                                <t t-set="lines_of_products" t-value="dict([(l.product_id.id, l.product_qty) for l in deliv.move_lines])"/>
                                <t t-foreach="stock" t-as="product"><td t-esc="'%d' % lines_of_products.get(product.id, 0)" class="text-center"/></t>
                           </tr>
                           <tr>
                                <th>Summe</th>
                                <th/>
                                <t t-foreach="stock" t-as="product">
                                    <t t-set="lines_of_products_sum" t-value="sum([l.product_qty for deliv in open_deliveries for l in deliv.move_lines if l.product_id.id == product.id])"/>
                                    <th t-esc="int(lines_of_products_sum)" class="text-center cell"/>
                                </t>
                            </tr>
                        </table>
                    </div>
                    <!-- Returns -->
                    <div class="panel panel-default" style="display:inline-block">
                        <div class="panel-heading">
                            <h2 class="panel-title"><a name="returns" href="#returns">Retouren</a></h2>
                        </div>
                        <table class="table table-hover table-condensed">
                            <colgroup width="200"/>
                            <tr>
                                <th class="big-cell">Datum</th>
                                <th class="big-cell">Referenz</th>
                                <t t-foreach="stock" t-as="product"><th t-esc="product.name" class="text-center cell"/></t>
                            </tr>
                            <tr t-foreach="returns" t-as="deliv">
                                <td t-esc="str(deliv.date)[:10]"/>
                                <!-- <td><a t-att-href="'/web#model=stock.picking&amp;view_type=form&amp;id=%d' % deliv.id" target="_blank"><t t-esc="deliv.name"/></a></td> -->
                                <td><a t-att-href="'/report/pdf/stock.report_picking/%d' % deliv.id" target="_blank"><t t-esc="deliv.name"/></a></td>
                                <t t-set="prodgroup" t-value="dict([(l.product_id.id, 0) for l in deliv.move_lines])"/>
                                <t t-set="prodgroup2" t-value="[prodgroup.update({l.product_id.id: prodgroup.get(l.product_id.id, 0) + l.product_qty}) for l in deliv.move_lines]"/>
                                <t t-set="lines_of_products" t-value="dict([(l.product_id.id, prodgroup.get(l.product_id.id, 0)) for l in deliv.move_lines])"/>
                                <t t-foreach="stock" t-as="product"><td t-esc="'%d' % lines_of_products.get(product.id, 0)" class="text-center cell"/></t>
                           </tr>
                           <tr>
                                <th>Summe</th>
                                <th/>
                                <t t-foreach="stock" t-as="product">
                                    <t t-set="lines_of_products_sum" t-value="sum([l.product_qty for deliv in open_deliveries for l in deliv.move_lines if l.product_id.id == product.id])"/>
                                    <th t-esc="int(lines_of_products_sum)" class="text-center cell"/>
                                </t>
                            </tr>
                        </table>
                    </div>
                    <!-- Invoices -->
                    <div class="panel panel-default" style="display:inline-block">
                        <div class="panel-heading">
                            <h2 class="panel-title"><a name="invoices" href="#invoices">Rechnungen</a></h2>
                        </div>
                        <table class="table table-hover table-condensed">
                            <colgroup width="200"/>
                            <tr>
                                <th class="big-cell">Datum</th>
                                <th class="big-cell">Referenz</th>
                                <th class="big-cell">Zahlungsziel</th>
                                <th class="text-right big-cell">Gesamtbetrag</th>
                                <th class="text-right cell">Status</th>
                                <t t-foreach="stock" t-as="product"><th t-esc="product.name" class="text-center cell"/></t>
                            </tr>
                            <t t-foreach="invoices" t-as="inv" >
                                <tr t-att-class="'danger' if overdues[inv.id] else ('info' if inv.state == 'open' else '')">
                                    <td t-esc="inv.date_invoice" />
                                    <td><a t-att-href="'/report/pdf/account.report_invoice/%d' % inv.id" target="_blank"><t t-esc="inv.number"/></a></td>
                                    <td t-esc="inv.date_due" />
                                    <td class="text-right" t-esc="'%.2f' % inv.amount_total" />
                                    <td class="text-right" t-esc="inv.state" />
                                    <t t-set="lines_of_products" t-value="dict([(l.product_id.id, l.quantity) for l in inv.invoice_line_ids if l.product_id])"/>
                                    <t t-foreach="stock" t-as="product"><td t-esc="'%d' % lines_of_products.get(product.id, 0)" class="text-center"/></t>
                                </tr>
                           </t>

                            <tr>
                                <th>Summe</th>
                                <th/><th/><th/><th/>
                                <t t-foreach="stock" t-as="product">
                                    <t t-set="lines_of_products_sum" t-value="sum([l.quantity for inv in invoices for l in inv.invoice_line_ids if l.product_id.id == product.id])"/>
                                    <th t-esc="int(lines_of_products_sum)" class="text-center cell"/>
                                </t>
                            </tr>

                        </table>
                    </div>
                    <!-- Stock -->
                    <div class="panel panel-default" style="display:inline-block">
                        <div class="panel-heading">
                            <h3 class="panel-title"><a name="stock" href="#stock">Lagerbestand</a></h3>
                        </div>
                        <table class="table table-hover table-condensed">
                            <tr>
                                <th class="big-cell"></th>
                                <t t-foreach="stock" t-as="product">
                                    <th t-esc="product.name" class="text-center cell"/>
                                </t>
                            </tr>
                            <tr>
                                <th>Aktueller Lagerbestand</th>
                                <t t-foreach="stock" t-as="product">
                                    <td t-esc="'%d' % product.qty_available" class="text-center"/>
                                </t>
                            </tr>
                            <tr>
                                <th>Zielbestand</th>
                                <t t-foreach="stock" t-as="product">
                                    <t t-set="orderpoints" t-value="[op.product_min_qty for op in product.orderpoint_ids if op.location_id.id == location_id]"/>
                                    <td t-esc="('%d' % orderpoints[0]) if orderpoints else 'n/a'" class="text-center"/>
                                </t>
                            </tr>
                        </table>
                    </div>
                    <div class="panel panel-default" style="display:inline-block">
                        <div class="panel-heading">
                            <h3 class="panel-title"><a name="zielbestand" href="#zielbestand">Zielbestand</a></h3>
                        </div>
                        <table class="table table-hover table-condensed">
                            <tr>
                                <td>Sie möchten Ihren Zielbestand dauerhaft ändern? Bitte sprechen Sie uns an, damit wir die Änderung gemeinsam mit Ihnen besprechen und vornehmen können.</td>
                            </tr>
                        </table>
                    </div>
                    <center>
                        <a href="/website/action/website_b2b.welcome" class="btn btn-primary hidden-print">Zurück</a>
                    </center>
                    <br/><br/>
                </div>
            </div>
        </t>
    </template>

    <template id="lines_widget" name="B2B Lines Widget">
        <td>
            <div class="row" t-foreach='deliv.move_lines' t-as='line' >
                <div class="col-xs-8" t-esc="line.product_id.name"/>
                <div class="col-xs-4" t-esc="'%d' % line.product_qty"/>
            </div>
        </td>
    </template>

    <!-- Util -->
    <template id="401" name="B2B 401">
        <t t-call="website.layout">
            <div class="wrap">
                <div class="container">
                    <div class="jumbotron mt32">
                        <h1>Retailer Portal</h1>
                        <p>You must be <a href="/web/login?redirect=/website/action/website_b2b.welcome">logged in</a> to see something here.</p>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <template id="debug" name="B2B Home Page">
        <t t-call="website.layout">
            <div class="wrap">
                <div class="container">
                    <div class="jumbotron mt32">
                        <p t-esc="data"/>
                    </div>
                </div>
            </div>
        </t>
    </template>

<template id="footer_custom_fw" inherit_id="website.layout" name="FooterFW">
    <xpath expr="//div[@id='footer']" position="replace">
        <div class="oe_structure" id="footer">
            <section>
                <div class="container">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="col-md-4">
                                <h3 style="color:#d2232a">Sie benötigen Hilfe?</h3>
                                <p>
                                    Sie haben Fragen zum Kommissionsmodell
                                    oder benötigen Hilfe bei der Bedienung
                                    dieser Seite? Unser Innendienst hilft Ihnen
                                    gerne weiter.
                                </p>
                            </div>
                            <div class="col-md-4" style="padding: 30px">
                                <table>
                                    <tr>
                                        <td>
                                <img src="/website_b2b/static/src/img/isk.png" style="max-width:100px"/>
                                        </td>
                                        <td>
                                            <p>Ildiko Schmitz-Kilian<br/>
                                            Tel. 0221 46 89 23 14<br/>
                                            eMail: ildiko@feuerwear.de</p>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            <div class="col-md-4" style="padding: 30px">
                                <table>
                                    <tr>
                                        <td>
                                <img src="/website_b2b/static/src/img/ap.png" style="max-width:100px"/>
                                        </td>
                                        <td>
                                            <p>Anne Päffgen<br/>
                                            Tel. 0221 46 89 23 18<br/>
                                            eMail: anne@feuerwear.de<br/>
                                            </p>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                        <div class="col-md-12 footer-address">
                            <div class="col-md-3">
                                FEUERWEAR GmbH &amp; Co. KG<br/>
								Wilhelm-Mauser-Str. 47<br/>
								50827 Köln<br/>
								Deutschland<br/><br/>
                            </div>
                            <div class="col-md-3">
								Tel +49 (0)221 46 89 23 - 0<br/>
								Fax +49 (0)221 46 89 23 - 41<br/>
								Mail info@feuerwear.de<br/>
								Web www.feuerwear.de<br/><br/>
                            </div>
                            <div class="col-md-2">
								Handelsregister<br/>
								Registergericht<br/>
								Köln<br/>
								HR A 26737<br/><br/>
                            </div>
                            <div class="col-md-2">
								Komplementär<br/>
								Feuerwear-Verwaltungs GmbH<br/>
								Registergericht Köln<br/>
								HR B 65071<br/><br/>
                            </div>
                            <div class="col-md-2">
								Geschäftsführung<br/>
								Martin Klüsener<br/>
								Robert Klüsener<br/>
								Sitz Köln<br/><br/>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </xpath>
</template>

</data>
</openerp>
